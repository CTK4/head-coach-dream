import { useMemo } from "react";
import { useGame } from "@/context/GameContext";
import { genProspects } from "@/engine/offseasonGen";
import { Card, CardContent } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";

export default function PreDraft() { const { state, dispatch } = useGame(); const board = useMemo(() => genProspects(state.saveSeed ^ 0x55555555, 80).slice(0, 40), [state.saveSeed]); const visits = state.offseasonData.preDraft.visits; const toggle = (id: string) => dispatch({ type: "PREDRAFT_TOGGLE_VISIT", payload: { prospectId: id } }); const completeStep = () => dispatch({ type: "OFFSEASON_COMPLETE_STEP", payload: { stepId: "PRE_DRAFT" } }); const next = () => dispatch({ type: "OFFSEASON_ADVANCE_STEP" }); return <div className="p-4 md:p-8 space-y-4"><Card><CardContent className="p-6 flex items-center justify-between"><div className="space-y-1"><div className="text-xl font-bold">Pre-Draft</div><div className="text-sm text-muted-foreground">Top 30 visits / private workouts (MVP: toggle visits).</div></div><Badge variant="outline">Step 5</Badge></CardContent></Card><Card><CardContent className="p-5 space-y-3"><div className="flex items-center justify-between"><div className="font-semibold">Board</div><Badge variant="outline">{board.length}</Badge></div><div className="space-y-2 max-h-[560px] overflow-auto pr-1">{board.map((p,idx)=>{const v=!!visits[p.id];return <div key={p.id} className="border rounded-md px-3 py-2 flex items-center justify-between"><div className="min-w-0"><div className="font-medium truncate">#{idx+1} {p.name} <span className="text-muted-foreground">({p.pos})</span></div><div className="text-xs text-muted-foreground">Grade {p.grade} · RAS {p.ras} · Interview {p.interview} · {p.archetype}</div></div><Button size="sm" variant={v?"default":"outline"} onClick={()=>toggle(p.id)}>{v?"Visited":"Visit"}</Button></div>;})}</div></CardContent></Card><Card><CardContent className="p-6 flex items-center justify-between gap-3"><div className="text-sm text-muted-foreground">Visits are saved; complete when ready.</div><div className="flex gap-2"><Button variant="outline" onClick={completeStep}>Complete Step</Button><Button onClick={next} disabled={!state.offseason.stepsComplete.PRE_DRAFT}>Next →</Button></div></CardContent></Card></div>; }
